(()=>{"use strict";const e={int:(e,t)=>Math.floor(Math.random()*(t-e+1)+e),uint:t=>e.int(0,t),char:t=>t.charAt(e.uint(t.length-1))};class t{constructor({from:e,to:t,steps:s,stagger:o,noise:i,charset:r,origin:n,output:a}={}){Object.assign(this,{from:e,to:t,steps:s,stagger:o,noise:i,charset:r,origin:n,output:a}),this.length=Math.max(e.length,t.length),a&&(a.textform=this),this.build(),this.reset()}build(){const{length:t,from:s,to:o}=this,i=this.compute(),r=t=>{const r=s.charAt(t),n=o.charAt(t),a=e=>e.match(/\r|\n|\t/);if(a(r))return[{frame:0,char:r}];if(a(n))return[{frame:0,char:n}];const p=this.applyNoise(this.steps),h=i[t],l=h+p,d=t=>{const s=h+t;return{frame:s,char:s===h?r:s===l?n:e.char(this.charset)}};return Array.from({length:p+1},((e,t)=>d(t)))},n=Array.from({length:t},((e,t)=>r(t)));this.finalFrame=n.flat().reduce(((e,t)=>Math.max(e,t.frame)),0),this.scenario=n}compute(){const{length:e,stagger:t,origin:s}=this;return s?Array.from({length:e},((o,i)=>{const r=i-s,n=r>=0?r*t:(e+r)*t;return this.applyNoise(n)})):Array.from({length:e},((e,s)=>{const o=s*t;return this.applyNoise(o)}))}applyNoise(t){const{noise:s}=this;return s?e.int(t,t+s):t}getCharAt(e,t){const s=this.scenario[e];let o=s.filter((e=>e.frame===t))[0];if(!o){const e=s[0].frame,i=s[s.length-1].frame,r=t>i?i:e;o=s.filter((e=>e.frame===r))[0]}return o.char}reset(){this.progress=0}update(){const{frame:e,length:t,output:s}=this;this.chars=Array.from({length:t},((t,s)=>this.getCharAt(s,e))),this.text=this.chars.join(""),s&&s.update()}get frame(){return this._frame}set frame(e){e!==this._frame&&(this._frame=e,this.update())}get progress(){return this._progress}set progress(e){this._progress=e,this.frame=Math.round(this.finalFrame*e)}get hasOrigin(){const{origin:e,length:t}=this;return void 0!==e&&e>=0&&e<t}}class s{constructor(e=null,t=0){this.callbacks="function"==typeof e?[e]:e,this.fps=t,this.elapsed=0,this._previous=0,this._delta=0,this._isPlaying=!1}reset(){this.elapsed=0}start(){this._previous=this.now,this._delta=0,this._isPlaying=!0,this.requestAnimationFrame()}pause(){this._isPlaying=!1}stop(){this.pause(),this.reset()}update(){if(!this.isPlaying)return;const e=this.now,t=e-this._previous;this._previous=e,this._delta+=t,this.elapsed+=t;const s=this._frameDuration-this._delta;s<=0&&(this.callbacks.forEach((e=>e.call())),this._delta=Math.abs(s)),this.requestAnimationFrame()}requestAnimationFrame(){requestAnimationFrame(this.update.bind(this))}get fps(){return this._fps}set fps(e){this._fps=e,this._frameDuration=e>0?Math.floor(1e3/e):0}get isPlaying(){return this._isPlaying}get now(){return s.time.now()}}s.time=void 0===performance?Date:performance;const o={linear:e=>e},i={Sine:e=>1-Math.cos(e*Math.PI/2),Circ:e=>1-Math.sqrt(1-e*e),Quad:e=>Math.pow(e,2),Cubic:e=>Math.pow(e,4),Quart:e=>Math.pow(e,6),Quint:e=>Math.pow(e,8),Expo:e=>Math.pow(e,10)};Object.keys(i).forEach((e=>{const t=i[e];o["easeIn"+e]=t,o["easeOut"+e]=e=>1-t(1-e),o["easeInOut"+e]=e=>e<.5?t(2*e)/2:1-t(-2*e+2)/2}));const r={};Object.keys(o).forEach((e=>{let t=e.toUpperCase();const s=t.match(/(EASEINOUT|EASEOUT|EASEIN)(.*)/);if(s){const e=s[1].replace("EASE","").replace("INOUT","IN_OUT");t=`${s[2]}_${e}`}r[t]=e})),o.keys=r;class n{constructor({textform:e,delay:t,duration:i,easing:r,reversed:a,reverseSpeed:p,repeat:h,yoyo:l,onBegin:d,onUpdate:c,onChange:g,onComplete:u}={}){this.clock=new s(this.animate.bind(this),n.FPS_CAP),this._progress=0,this._isReversed=a,Object.assign(this,{textform:e,delay:t,duration:i,reverseSpeed:p,repeat:h,isYoyo:l,onBegin:d,onUpdate:c,onChange:g,onComplete:u}),this.ease=o[r]||o.linear}animate(){const{clock:e,duration:t,delay:s,reverseSpeed:o,isReversed:i,isYoyo:r,onBegin:n,onUpdate:a,onComplete:p}=this,h=i?o:1,l=e.elapsed*h-s;if(a&&a.call(),l<0)return;if(l>=t)return this.progress=Math.round(this.progress),r&&(this.isReversed=!i),this.stop(),i&&n?n.call():p&&p.call(),0!==this.repeat&&this.play(!1),void(this.repeat>0&&this.repeat--);const d=l/t;this.progress=i?1-d:d}reset(){const{textform:e,isReversed:t}=this;e.progress=t?1:0}play(e=!1){const{onBegin:t,onComplete:s,isPlaying:o,isReversed:i,isComplete:r}=this;(o||r)&&(this.stop(),e||this.reset(),i&&s?s.call():!i&&t&&t.call()),this.start()}start(){this.clock.start()}pause(){this.clock.pause()}stop(){this.clock.stop()}setClockFromProgress(){const{clock:e,progress:t,duration:s,reverseSpeed:o,delay:i,isReversed:r}=this;e.elapsed=r?(i+(1-t)*s)/o:i+t*s}get frame(){return this.textform.frame}get progress(){return this._progress}set progress(e){const{textform:t,ease:s,onChange:o}=this;e<0?e=0:e>1&&(e=1),this._progress=e,this.isPlaying||this.setClockFromProgress();const i=t.frame;t.progress=s(e),t.frame!==i&&o&&o.call()}get isReversed(){return this._isReversed}set isReversed(e){e!==this._isReversed&&(this._isReversed=e,this.setClockFromProgress())}get isPlaying(){return this.clock.isPlaying}get isComplete(){const{progress:e,isReversed:t}=this;return t?e<=0:e>=1}}n.FPS_CAP=60;class a extends t{compute(){return super.compute().reverse()}}class p extends t{compute(){const{length:e,stagger:t,origin:s,hasOrigin:o}=this,i=o?s:Math.floor((e-1)/2),r=o||e%2!=0?i:i+1;return Array.from({length:e},((e,s)=>{const o=s<r?i-s:s-r;return this.applyNoise(o*t)}))}}class h extends t{compute(){const{length:e,stagger:t,origin:s,hasOrigin:o}=this,i=o?s:Math.round((e-1)/2);return Array.from({length:e},((s,o)=>{const r=o<i?o:e-1-o;return this.applyNoise(r*t)}))}}class l extends t{compute(){const{origin:e,stagger:t}=this;let s=l.shuffle(super.compute());return this.hasOrigin&&t>0?(s=s.filter((e=>e>0)),s.splice(e,0,0),s):s}}l.shuffle=e=>{let t=[...e];for(let s=e.length-1;s>0;s--){const e=Math.floor(Math.random()*(s+1));[t[s],t[e]]=[t[e],t[s]]}return t};const d="ABCDEFGHIJKLMNOPQRSTUVWXYZ",c=d.toLowerCase(),g="0123456789",u="!@#$%&?",m=[d,c,g,u].join(""),f={UPPERCASE:d,LOWERCASE:c,DIGITS:g,SYMBOLS:u,ALL:m},y={pad:(e,t,s,o)=>{const i=o-e.length;if(0===i)return e;const r={left:()=>0,center:()=>Math.floor(i/2),right:()=>i,default:()=>t};return(n=s,a=e,p=(r[t]||r.default)(),[n.slice(0,p),a,n.slice(p)].join("")).slice(0,o);var n,a,p},align:(e,t,s)=>{if(t===y.to.NONE)return e;s||(s=" ");const o=e.reduce(((e,t)=>Math.max(e,t.length)),0),i=s.length,r=Math.ceil(o/i),n=s.repeat(r).substring(0,o);return e.map((e=>y.pad(e,t,n,o)))},to:{NONE:"none",LEFT:"left",CENTER:"center",RIGHT:"right"}};class v{constructor(e){this.input=e}update(){if(!this.textform)return;const e=this.textform.text;if(this.object)return this.object.textform=e;if(this.console)return console.log(e);const t=e.replace(/ /g,"&nbsp;").replace(/\t/g,"&emsp;").replace(/\n/g,"<br>");this.elements&&this.elements.forEach((e=>e.innerHTML=t))}get input(){return this._input}set input(e){if(delete this.console,delete this.elements,delete this.object,void 0!==e)if(e!==console)if(void 0===e.innerHTML){if("string"==typeof e){const t=/\.\w\S*/;if(e.match(t)){const t=document.getElementsByClassName(e.substring(1));return void(t.length&&(this.elements=Array.from(t)))}const s=/#\w\S*/;if(e.match(s)){const t=document.querySelector(e);return void(t&&(this.elements=[t]))}}try{void 0===e.textform&&(e.textform=""),this.object=e}catch(e){return}}else this.elements=[e];else this.console=e}get isValid(){return void 0!==this.object||void 0!==this.console||void 0!==this.elements}get inputText(){return this.object&&this.object.textform?this.object.textform:this.elements?this.elements[0].textContent:void 0}}class b{constructor({mode:e=b.modes.BASIC,from:t,to:s,steps:o=5,stagger:i=3,noise:r=0,charset:n=b.charsets.ALL,origin:a,output:p,align:h=b.align.NONE,fill:l=" ",autoplay:d=!0,speed:c=b.DEFAULT_SPEED,easing:g=b.DEFAULT_EASING,delay:u=0,duration:m=0,reversed:f=!1,reverseSpeed:y=1,repeat:v=0,loop:_=!1,yoyo:x=!1,onBegin:E,onUpdate:w,onChange:C,onComplete:A,hover:T=!1,press:k=!1}={}){this.__init(),this.build({mode:e,from:t,to:s,steps:o,stagger:i,noise:r,charset:n,origin:a,output:p,align:h,fill:l,autoplay:d,speed:c,easing:g,delay:u,duration:m,reversed:f,reverseSpeed:y,repeat:v,loop:_,yoyo:x,onBegin:E,onUpdate:w,onChange:C,onComplete:A,hover:T,press:k})}build(e=this.options){this.options=e,this.destroy();const s={default:t,basic:t,reverse:a,expand:p,collapse:h,shuffle:l},o=new(s[e.mode]||s.default)(this.__.textformOptions());if(this.textform=o,e.hover||e.press)this.bind();else if(!e.autoplay)return;this.player=new n(this.__.autoplayOptions()),e.autoplay&&this.play()}clone(e={output:void 0}){const t={...this.options,...e};return new b(t)}destroy(){this.stop(),delete this.player,delete this.textform,this.unbind()}convertSpeedToDuration(e=this.options.speed){return this.textform?this.textform.finalFrame*(1e3/e):b.DEFAULT_DURATION}__init(){const e={};e.in=function(){const{player:e}=this;e&&(e.isReversed=!1),!e.isPlaying&&e.progress<1&&e.play()}.bind(this),e.out=function(){const{player:e}=this;e&&(e.isReversed=!0),!e.isPlaying&&e.progress>0&&e.play()}.bind(this),e.textformOptions=function(){const{DEFAULT_TEXT:e}=b,t={...this.options},{from:s,to:o,align:i,fill:r}=t,n=new v(t.output);if(n.isValid){t.output=n;const i=n.inputText||e;void 0===s&&(t.from=i),void 0===o&&(t.to=i)}else delete t.output;if(void 0===s&&(t.from=e),void 0===o&&(t.to=e),i){const e=y.align([t.from,t.to],i,r);t.from=e[0],t.to=e[1]}return t}.bind(this),e.autoplayOptions=function(){const{textform:e}=this,t={...this.options,textform:e};return t.duration||(t.duration=this.convertSpeedToDuration(t.speed)),t.loop&&(t.repeat=-1),t}.bind(this),this.__=e}bind(e=this.options.hover,t=this.options.press){const{textform:s,options:o}=this;if(Object.assign(o,{hover:e,press:t}),!e&&!t)return;if(!s||!s.output||!s.output.elements)return;const{elements:i}=s.output;i.forEach((s=>{e&&(s.addEventListener("pointerenter",this.__.in),s.addEventListener("pointerleave",this.__.out)),t&&(s.addEventListener("pointerdown",this.__.in),s.addEventListener("pointerup",this.__.out))})),this.dispatchers=i}unbind(){this.dispatchers&&(this.dispatchers.forEach((e=>{e.addEventListener("pointerenter",this.__.in),e.addEventListener("pointerleave",this.__.out),e.addEventListener("pointerdown",this.__.in),e.addEventListener("pointerup",this.__.out)})),delete this.dispatchers)}play(){this.player&&this.player.play()}pause(){this.player&&this.player.pause()}stop(){this.player&&this.player.stop()}get progress(){return this.player?this.player.progress:this.textform.progress}set progress(e){this.player?this.player.progress=e:this.textform.progress=e}get speed(){return this.options.speed}set speed(e){const{options:t}=this;e<1&&(e=b.DEFAULT_SPEED),t.speed=e,t.duration=this.convertSpeedToDuration(e)}get text(){return this.textform.text}}b.align=y.to,b.charsets=f,b.ease=o.keys,b.modes={BASIC:"basic",REVERSE:"reverse",EXPAND:"expand",COLLAPSE:"collapse",SHUFFLE:"shuffle"},b.DEFAULT_TEXT="",b.DEFAULT_SPEED=15,b.DEFAULT_DURATION=1e3,b.DEFAULT_EASING=b.ease.LINEAR;const _=dat.gui,x=new b({output:"#demo-title",from:"",to:"Textformer",mode:b.modes.EXPAND,steps:20,stagger:3,noise:0,speed:15,easing:b.ease.CIRC_OUT,delay:500,align:b.align.LEFT,fill:"."}),E="\nEasy text animations with\nrandom character changes.\n\nExample usage :\n\nconst textformer = new Textformer( {\n\n\t//Target\n\toutput: \"#demo-title\",\n\n\t//Texts\n\tfrom: '',\n\tto: 'Textformer',\n\n\t//Options\n\tmode: Textformer.modes.EXPAND,\n\tsteps: 20,\n\tstagger: 3,\n\n\t//Autoplay\n\tspeed: 15,\n\teasing: Textformer.ease.CIRC_OUT,\n\tdelay: 500,\n\n} );\n",w={element:document.querySelector("#demo-paragraph"),build:()=>{w.textformer.build({...x.options,...w.getOverrides()})},getOverrides:()=>{const e=x.textform.length,t=e>0?E.length/e*.25:10;return{output:w.element,from:"",to:E,stagger:Math.ceil(x.options.stagger/t),duration:x.options.duration||x.convertSpeedToDuration(x.options.speed),noise:0===x.options.noise?0:x.options.noise*t}}};w.textformer=x.clone(w.getOverrides()),x.options.duration||(x.options.duration=x.convertSpeedToDuration()),void 0===x.options.origin&&(x.options.origin=-1),x.player.onBegin=x.player.onComplete=()=>{const{options:e,player:t}=x;e.reversed=t.isReversed};const C=new _.GUI;C.controls={play:()=>{const e=x.player.isPlaying?"pause":"play";x[e](),w.textformer[e]()},rebuild:()=>{x.build(),w.build()},setPlayersProperty:(e,t)=>{x.player[e]=t,w.textformer.player[e]=t},updatePlayers:()=>{const{setPlayersProperty:e,play:t}=C.controls;e("repeat",x.options.loop?-1:0),e("isReversed",x.options.reversed),e("isYoyo",x.options.yoyo),e("ease",basicEasing[x.options.easing]),x.player.isPlaying||t()},updateProgress:()=>{x.pause(),w.textformer.pause(),C.controls.setPlayersProperty("progress",x.progress)}};const{rebuild:A,updatePlayers:T,updateProgress:k}=C.controls,P=C.addFolder("Textform");P.add(x.options,"from").onChange(A),P.add(x.options,"to").onChange(A),P.add(x.options,"mode",b.modes).onChange(A),P.add(x.options,"steps",1,60).step(1).onChange(A),P.add(x.options,"stagger",0,30).step(1).onChange(A),P.add(x.options,"noise",0,30).step(1).onChange(A),P.open();const S=C.addFolder("Animation");S.add(x,"speed",1,30).step(1).onChange(A),S.add(x.options,"easing",b.ease).onChange(T),S.add(x,"progress",0,1).step(.001).onChange(k).listen(),S.add(C.controls,"play"),S.open();const O=C.addFolder("Advanced");O.add(x.options,"charset",b.charsets).onChange(A),O.add(x.options,"align",b.align).onChange(A),O.add(x.options,"fill").onChange(A),O.add(x.options,"origin",-1,10).step(1).onChange(A);const L=C.addFolder("Advanced ( Animation )");L.add(x.options,"reversed").onChange(T).listen(),L.add(x.options,"loop").onChange(T),L.add(x.options,"yoyo").onChange(T),L.add(x.options,"delay",0,5e3).step(50).onChange(A),L.add(x.options,"duration",150,1e4).step(50).onChange(A).listen(),L.open();const F=navigator.userAgent||navigator.vendor||window.opera,M=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|mediump|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(F)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(F.substr(0,4)),R=window.innerWidth<640;(M||R)&&C.close()})();