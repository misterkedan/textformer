(()=>{"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var n=function(){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.output,o=e.from,i=e.to,a=e.steps,s=e.stagger,u=e.charset,l=e.align,f=e.fill;t(this,n),Object.assign(this,{output:r,from:o,to:i,steps:a,stagger:s,charset:u}),this.length=Math.max(o.length,i.length),this.align(l,f),this.build(),this.reset()}var r,o;return r=n,(o=[{key:"align",value:function(t,e){if(t){var n=this.to.length-this.from.length;if(0!==n){for(var r=n>0?"from":"to",o=this[r],i=[],a=Math.abs(n),s=0;s<a;s++)i.push(e||this.getRandomChar());this[r]=t(o,i.join(""))}}}},{key:"build",value:function(){this.changes=[],console.warn("Abstract class")}},{key:"getRandomChar",value:function(){var t=this.charset,e=Math.floor(Math.random()*t.length);return t.charAt(e)}},{key:"getCharAtFrame",value:function(t,e){var n=this.changes[t],r=n.filter((function(t){return t.frame===e}))[0];if(!r){var o=n[0].frame,i=n[n.length-1].frame,a=e>i?i:o;r=n.filter((function(t){return t.frame===a}))[0]}return r.char}},{key:"reset",value:function(){this.progress=0}},{key:"update",value:function(){for(var t=this.frame,e=[],n=0,r=this.length;n<r;n++)e.push(this.getCharAtFrame(n,t));this.text=e.join(""),this.output&&(this.output.textContent=this.text)}},{key:"frame",get:function(){return this._frame},set:function(t){t!==this._frame&&(this._frame=t,this.update())}},{key:"progress",get:function(){return this._progress},set:function(t){this._progress=t,this.frame=Math.round(this.totalFrames*t)}}])&&e(r.prototype,o),n}();function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t,e){if(e&&("object"===r(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}n.charsets={UPPERCASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",DIGITS:"0123456789",SYMBOLS:"!@#$%&?"},n.charsets.LOWERCASE=n.charsets.UPPERCASE.toLowerCase(),n.charsets.ALL=Object.values(n.charsets).join(""),n.aligns={NONE:!1,LEFT:function(t,e){return t+e},CENTER:function(t,e){var n=e.length,r=Math.floor(n/2);return e.substring(0,r)+t+e.substring(r,n)},RIGHT:function(t,e){return e+t}};var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(h,t);var e,n,r,l,f=(r=h,l=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=u(r);if(l){var n=u(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return s(this,t)});function h(){return o(this,h),f.apply(this,arguments)}return e=h,(n=[{key:"build",value:function(){for(var t=[],e=this.length,n=this.from,r=this.to,o=this.steps,i=this.stagger,a=0;a<e;a++){var s=[],u=a*i,l=u+o,f=n.charAt(a),h=r.charAt(a);s.push({frame:u,char:f});for(var c=u+1;c<l;c++){var p=this.getRandomChar();s.push({frame:c,char:p})}s.push({frame:l,char:h}),t[a]=s}this.changes=t,this.totalFrames=(e-1)*i+o}}])&&i(e.prototype,n),h}(n);function f(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var c=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.textform,r=e.duration,o=e.delay,i=e.onBegin,a=e.onChange,s=e.onComplete;f(this,t),Object.assign(this,{textform:n,duration:r,delay:o,onBegin:i,onChange:a,onComplete:s})}var e,n;return e=t,(n=[{key:"animate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this.textform,n=this.onChange,r=this.onComplete,o=this.duration;this.time||(this.time=t);var i=t-this.time;if(i>o)return e.progress=1,r&&r.call(),this.stop();var a=e.frame;e.progress=i/o,e.frame!==a&&n&&n.call(),this.requestAnimationFrame()}},{key:"requestAnimationFrame",value:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(){this.animationFrame=requestAnimationFrame(this.animate.bind(this))}))},{key:"play",value:function(){var t=this.onBegin;t&&t.call(),this.time=0,this.textform.progress=0;var e=this.delay>0?this.delay:0;this.timeout=setTimeout(this.requestAnimationFrame.bind(this),e)}},{key:"stop",value:function(){clearTimeout(this.timeout),cancelAnimationFrame(this.animationFrame)}}])&&h(e.prototype,n),t}();function p(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var g=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.mode,o=void 0===r?t.modes.rightward:r,i=e.autoPlay,a=void 0===i||i,s=e.speed,u=void 0===s?15:s,l=e.output,f=e.from,h=void 0===f?"Demo":f,c=e.to,d=void 0===c?"Textformer":c,g=e.steps,m=void 0===g?5:g,y=e.stagger,v=void 0===y?3:y,b=e.charset,C=void 0===b?n.charsets.ALL:b,O=e.align,w=void 0===O?n.aligns.NONE:O,k=e.fill,x=void 0===k?" ":k,A=e.delay,j=void 0===A?0:A,E=e.duration,F=e.onBegin,P=e.onChange,S=e.onComplete;p(this,t),Object.assign(this,{mode:o,autoPlay:a,speed:u,options:{output:l,from:h,to:d,steps:m,stagger:v,charset:C,align:w,fill:x},playerOptions:{duration:E,delay:j,onBegin:F,onChange:P,onComplete:S}}),this.build()}var e,r;return e=t,(r=[{key:"build",value:function(){var t=new this.mode(this.options);if(this.textform=t,this.autoPlay){var e=this.playerOptions;if(!e.duration){var n=Math.abs(this.speed)||1;e.duration=this.textform.totalFrames*(1e3/n)}e.textform=t,this.player=new c(e),this.play()}}},{key:"play",value:function(){this.player&&this.player.play()}},{key:"replay",value:function(){this.player&&(this.player.stop(),this.build())}},{key:"progress",get:function(){return this.textform.progress},set:function(t){this.textform.progress=t}},{key:"text",get:function(){return this.textform.text}}])&&d(e.prototype,r),t}();g.modes={rightward:l};const m=dat.gui;var y=new g({output:document.querySelector("#demo-text"),from:"Demo",to:"Textformer",steps:5,stagger:3,speed:15,delay:500});function v(){"string"==typeof y.options.align&&(y.options.align=n.aligns[y.options.align]),y.options.fill.length>0&&(y.options.fill=y.options.fill.charAt(0)),y.build()}var b=new m.GUI,C=b.addFolder("Textform");C.add(y.options,"from").onChange(v),C.add(y.options,"to").onChange(v),C.add(y.options,"steps",1,60).step(1).onChange(v),C.add(y.options,"stagger",0,30).step(1).onChange(v),C.open();var O=b.addFolder("Animation");O.add(y,"speed",1,30).step(1).onChange((function(){y.playerOptions.duration=0,y.build(),b.updateDisplay()})),O.add(y,"progress",0,1).step(.001).listen(),O.add(y,"replay"),O.open();var w=b.addFolder("Advanced");w.add(y.options,"align",Object.keys(n.aligns)).onChange(v),w.add(y.options,"fill").onChange(v),w.add(y.options,"charset",n.charsets).onChange(v),w.add(y.playerOptions,"duration",150,1e4).step(50).onChange(v),w.add(y.playerOptions,"delay",0,5e3).step(50).onChange(v)})();