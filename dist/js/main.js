(()=>{"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var n=function(){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.output,o=e.from,i=e.to,a=e.steps,u=e.stagger,s=e.charset,f=e.align,c=e.fill;t(this,n),Object.assign(this,{output:r,from:o,to:i,steps:a,stagger:u,charset:s}),this.length=Math.max(o.length,i.length),this.align(f,c),this.build(),this.reset()}var r,o;return r=n,(o=[{key:"align",value:function(t,e){if(t){var n=this.to.length-this.from.length;if(0!==n){for(var r=n>0?"from":"to",o=this[r],i=[],a=Math.abs(n),u=0;u<a;u++)i.push(e||this.getRandomChar());this[r]=t(o,i.join(""))}}}},{key:"build",value:function(){for(var t=[],e=this.length,n=this.from,r=this.to,o=this.steps,i=this.computeStartFrames(),a=0;a<e;a++){var u=[],s=i[a],f=s+o,c=n.charAt(a),l=r.charAt(a);u.push({frame:s,char:c});for(var p=s+1;p<f;p++){var h=this.getRandomChar();u.push({frame:p,char:h})}u.push({frame:f,char:l}),t[a]=u}this.changes=t,this.totalFrames=Math.max.apply(Math,t.map((function(t){return t.map((function(t){return t.frame}))})).flat())}},{key:"computeStartFrames",value:function(){for(var t=this.length,e=this.stagger,n=[],r=0;r<t;r++)n.push(r*e);return n}},{key:"getRandomChar",value:function(){var t=this.charset,e=Math.floor(Math.random()*t.length);return t.charAt(e)}},{key:"getCharAtFrame",value:function(t,e){var n=this.changes[t],r=n.filter((function(t){return t.frame===e}))[0];if(!r){var o=n[0].frame,i=n[n.length-1].frame,a=e>i?i:o;r=n.filter((function(t){return t.frame===a}))[0]}return r.char}},{key:"reset",value:function(){this.progress=0}},{key:"update",value:function(){for(var t=this.frame,e=[],n=0,r=this.length;n<r;n++)e.push(this.getCharAtFrame(n,t));this.text=e.join(""),this.output&&(this.output.textContent=this.text)}},{key:"frame",get:function(){return this._frame},set:function(t){t!==this._frame&&(this._frame=t,this.update())}},{key:"progress",get:function(){return this._progress},set:function(t){this._progress=t,this.frame=Math.round(this.totalFrames*t)}}])&&e(r.prototype,o),n}();function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t,e){if(e&&("object"===r(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}n.charsets={UPPERCASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",DIGITS:"0123456789",SYMBOLS:"!@#$%&?"},n.charsets.LOWERCASE=n.charsets.UPPERCASE.toLowerCase(),n.charsets.ALL=Object.values(n.charsets).join(""),n.aligns={none:!1,left:function(t,e){return t+e},center:function(t,e){var n=e.length,r=Math.floor(n/2);return e.substring(0,r)+t+e.substring(r,n)},right:function(t,e){return e+t}};var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(l,t);var e,n,r,f,c=(r=l,f=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=s(r);if(f){var n=s(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return u(this,t)});function l(){return o(this,l),c.apply(this,arguments)}return e=l,(n=[{key:"computeStartFrames",value:function(){for(var t=this.length,e=this.steps,n=[],r=.382*t*this.stagger+e,o=0;o<t;o++)n.push(Math.floor(Math.random()*(r-0+1)+0));return n}}])&&i(e.prototype,n),l}(n);function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function p(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t,e,n){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=d(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function y(t,e){return(y=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function m(t,e){if(e&&("object"===c(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function d(t){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&y(t,e)}(a,t);var e,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=d(r);if(o){var n=d(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return m(this,t)});function a(){return l(this,a),i.apply(this,arguments)}return e=a,(n=[{key:"computeStartFrames",value:function(){return h(d(a.prototype),"computeStartFrames",this).call(this).reverse()}}])&&p(e.prototype,n),a}(n);function v(t){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function b(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function O(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function w(t,e,n){return(w="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=S(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function j(t,e){return(j=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function C(t,e){if(e&&("object"===v(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function S(t){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var P=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&j(t,e)}(a,t);var e,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=S(r);if(o){var n=S(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return C(this,t)});function a(){return b(this,a),i.apply(this,arguments)}return e=a,(n=[{key:"computeStartFrames",value:function(){var t=w(S(a.prototype),"computeStartFrames",this).call(this);return a.shuffle(t),t}}])&&O(e.prototype,n),a}(n);function R(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function k(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}P.shuffle=function(t){for(var e=t.length-1;e>0;e--){var n=Math.floor(Math.random()*(e+1)),r=[t[n],t[e]];t[e]=r[0],t[n]=r[1]}};var _=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.textform,r=e.duration,o=e.delay,i=e.onBegin,a=e.onChange,u=e.onComplete;R(this,t),Object.assign(this,{textform:n,duration:r,delay:o,onBegin:i,onChange:a,onComplete:u})}var e,n;return e=t,(n=[{key:"animate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this.textform,n=this.onChange,r=this.onComplete,o=this.duration;this.time||(this.time=t);var i=t-this.time;if(i>o)return e.progress=1,r&&r.call(),this.stop();var a=e.frame;e.progress=i/o,e.frame!==a&&n&&n.call(),this.requestAnimationFrame()}},{key:"requestAnimationFrame",value:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(){this.animationFrame=requestAnimationFrame(this.animate.bind(this))}))},{key:"play",value:function(){var t=this.onBegin;t&&t.call(),this.time=0,this.textform.progress=0;var e=this.delay>0?this.delay:0;this.timeout=setTimeout(this.requestAnimationFrame.bind(this),e)}},{key:"stop",value:function(){clearTimeout(this.timeout),cancelAnimationFrame(this.animationFrame)}}])&&k(e.prototype,n),t}();function x(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function F(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var E=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.mode,o=void 0===r?t.modes.default:r,i=e.autoPlay,a=void 0===i||i,u=e.speed,s=void 0===u?15:u,f=e.output,c=e.from,l=void 0===c?"Demo":c,p=e.to,h=void 0===p?"Textformer":p,y=e.steps,m=void 0===y?5:y,d=e.stagger,g=void 0===d?3:d,v=e.charset,b=void 0===v?n.charsets.ALL:v,O=e.align,w=void 0===O?n.aligns.none:O,j=e.fill,C=void 0===j?" ":j,S=e.delay,P=void 0===S?0:S,R=e.duration,k=e.onBegin,_=e.onChange,F=e.onComplete;x(this,t),Object.assign(this,{mode:o,autoPlay:a,speed:s,options:{output:f,from:l,to:h,steps:m,stagger:g,charset:b,align:w,fill:C},playerOptions:{duration:R,delay:P,onBegin:k,onChange:_,onComplete:F}}),this.build()}var e,r;return e=t,(r=[{key:"build",value:function(){this.mode.prototype instanceof n==0&&(this.mode=t.modes.default);var e=new this.mode(this.options);if(this.textform=e,this.autoPlay){var r=this.playerOptions;if(!r.duration){var o=Math.abs(this.speed)||1;r.duration=this.textform.totalFrames*(1e3/o)}r.textform=e,this.player&&this.player.stop(),this.player=new _(r),this.play()}}},{key:"play",value:function(){this.player&&this.player.play()}},{key:"replay",value:function(){this.player&&(this.player.stop(),this.player.play())}},{key:"progress",get:function(){return this.textform.progress},set:function(t){this.textform.progress=t}},{key:"text",get:function(){return this.textform.text}}])&&F(e.prototype,r),t}();E.modes={default:n,reversed:g,shuffled:P,random:f};const A=dat.gui;var T={output:document.querySelector("#demo-text"),from:"",to:"Textformer",steps:5,stagger:3,mode:E.modes.default,speed:15,delay:500,align:n.aligns.left},M=new E(T);function B(){M.mode=E.modes[T.mode],M.options.align=n.aligns[T.align],M.options.fill.length>0&&(M.options.fill=M.options.fill.charAt(0)),M.playerOptions.duration=0,M.build(),D.updateDisplay()}T.mode="default",T.align="left";var D=new A.GUI,L=D.addFolder("Textform");L.add(M.options,"from").onChange(B),L.add(M.options,"to").onChange(B),L.add(T,"mode",Object.keys(E.modes)).onChange(B),L.add(M.options,"steps",1,60).step(1).onChange(B),L.add(M.options,"stagger",0,30).step(1).onChange(B),L.open();var q=D.addFolder("Animation");q.add(M,"speed",1,30).step(1).onChange(B),q.add(M,"progress",0,1).step(.001).listen(),q.add(M,"replay"),q.open();var I=D.addFolder("Advanced");I.add(T,"align",Object.keys(n.aligns)).onChange(B),I.add(M.options,"fill").onChange(B),I.add(M.options,"charset",n.charsets).onChange(B),I.add(M.playerOptions,"duration",150,1e4).step(50).onChange((function(){M.build()})),I.add(M.playerOptions,"delay",0,5e3).step(50).onChange(B),I.open()})();